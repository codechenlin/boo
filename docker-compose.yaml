version: "3.9"

services:
  app-prod:
    container_name: bolt-app-prod
    build:
      context: .
      dockerfile: Dockerfile
      target: bolt-ai-production
    image: bolt-ai:production
    ports:
      - "5173:5173"
    env_file: 
      - ".env"
      - ".env.local"
    environment:
      - NODE_ENV=production
      - PORT=5173
      - RUNNING_IN_DOCKER=true
      # API keys (Coolify las inyecta desde variables de entorno)
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY}
      - HUGGINGFACE_API_KEY=${HUGGINGFACE_API_KEY}
      - GROQ_API_KEY=${GROQ_API_KEY}
    command: pnpm run dockerstart
    profiles:
      - production
